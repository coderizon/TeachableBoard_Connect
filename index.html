<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>MakerSpace ML & Micro:bit</title>
    <link rel="stylesheet" href="styles/main.css"> </head>
<body>
    <div id="landing-page" onclick="checkLogoClick(event)">
        <div id="svg-background"></div> 
        
        <img id="makerspace-logo" src="assets/images/makerspace.png" alt="Makerspace Logo starten">
        
        <p id="landing-message">Klicke auf das Logo, um die App zu starten</p>
    </div>

    <div id="model-url-dialog" class="hidden">
        <div class="dialog-content">
            <p class="dialog-title">Please paste the full Teachable Machine model URL:</p>
            <input type="text"
                   id="dialog-url-input"
                   placeholder="https://teachablemachine.withgoogle.com/models/XYZ/"
                   autocomplete="off">
            <p id="dialog-error" class="dialog-error hidden">Bitte gib einen gültigen Link ein.</p>
            <div class="dialog-actions">
                <button type="button" class="dialog-button primary" onclick="confirmModelUrl()">OK</button>
                <button type="button" class="dialog-button secondary" onclick="cancelModelUrlDialog()">Abbrechen</button>
            </div>
        </div>
    </div>

    <div id="main-app" class="hidden">
        <div class="app-shell">
            <header class="app-header">
                <p id="status-message" aria-live="polite"></p>
                <button id="bluetooth-button" type="button" aria-label="Bluetooth Geräte verbinden" onclick="handleBluetoothClick()">
                    <svg viewBox="0 0 24 24" aria-hidden="true">
                        <path d="M12.7 12l4.46-3.35a1 1 0 0 0 .09-1.54l-5.5-5.06a1 1 0 0 0-1.66.75v6.7L6.82 6.35a1 1 0 1 0-1.25 1.56L9.9 12l-4.33 4.09a1 1 0 1 0 1.25 1.56l3.27-3.05v6.7a1 1 0 0 0 1.66.75l5.5-5.06a1 1 0 0 0-.09-1.54L12.7 12zm-.61-8.55L14.9 7.2l-2.81 2.1V3.45zm0 17.1v-5.86l2.81 2.1-2.81 3.76z"/>
                    </svg>
                </button>
            </header>

            <main class="app-content">
                <div id="webcam-container" class="webcam-frame"></div>
                <div id="prediction-display" class="prediction-box hidden">—</div>
            </main>
        </div>

        <div id="bluetooth-popover" class="hidden" onclick="handlePopoverBackdrop(event)">
            <div class="popover-content">
                <h2>Wähle dein Gerät</h2>
                <button type="button" class="popover-button" onclick="selectMicrobit()">BBC micro:bit verbinden</button>
                <button type="button" class="popover-button" onclick="selectCalliope()">Calliope mini verbinden</button>
                <button type="button" class="popover-close" onclick="closeBluetoothPopover()">Abbrechen</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>
    
    <script src="scripts/bluetooth/microbit.js"></script> 
    <script src="scripts/bluetooth/calliope.js"></script> 
    <script src="scripts/app.js"></script>      
</body>
</html>
